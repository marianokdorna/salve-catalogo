<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Salve de Vero â€” Accesos</title>
  <style>
    :root {
      --bg: #fdeef5;
      --fg: #222;
      --muted: #666;
      --brand: #be185d;
      --border: #eec7d8;
      --card: #fff;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0; display: flex; align-items: center; justify-content: center;
      flex-direction: column; background: var(--bg); color: var(--fg);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
    }
    .logo {
      width: 120px; height: 120px; object-fit: cover; border-radius: 50%;
      margin-bottom: 16px; box-shadow: 0 4px 12px rgba(0,0,0,.1);
    }
    h1 { color: var(--brand); font-size: 22px; margin-bottom: 8px; }
    p { color: var(--muted); margin-bottom: 24px; font-size: 14px; }

    .buttons { display: flex; gap: 12px; }
    button {
      padding: 12px 20px; border: none; border-radius: 12px; cursor: pointer;
      font-weight: 600; font-size: 16px; transition: transform .1s ease-in-out;
    }
    button:hover { transform: scale(1.05); }
    .btn-primary { background: var(--brand); color: #fff; }
    .btn-secondary { background: #fff; color: var(--brand); border: 2px solid var(--brand); }
    .logout { position: fixed; right: 12px; top: 12px; background: #fff; border: 2px solid var(--border); color: var(--brand); }

    /* Gate (pantalla de clave) */
    .gate {
      position: fixed; inset: 0; display: grid; place-items: center; background: var(--bg);
    }
    .card {
      background: var(--card); border: 2px solid var(--border); border-radius: 16px;
      padding: 20px; width: min(92vw, 420px); box-shadow: 0 6px 24px rgba(190,24,93,.08);
    }
    .card h2 { margin: 0 0 10px; color: var(--brand); font-size: 20px; }
    .card label { font-size: 14px; color: var(--muted); display: block; margin-bottom: 8px; }
    .card input {
      width: 100%; padding: 12px 14px; border-radius: 12px; border: 2px solid var(--border); background: #fff;
      outline: none; font-size: 16px;
    }
    .card input:focus { border-color: var(--brand); box-shadow: 0 0 0 3px rgba(190,24,93,.15); }
    .card .row { display: flex; gap: 8px; margin-top: 12px; }
    .error { color: #b91c1c; margin-top: 8px; font-size: 13px; }
    /* Oculto el app hasta pasar la clave */
    #app { display: none; }

    /* === utilidades de visibilidad === */
    .hidden {
      display: none !important;
    }

    /* Asegura que el app use su layout original */
    #app {
      display: block;
    }
  
    /* === CorrecciÃ³n de centrado para el contenedor principal === */
    #app {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      text-align: center;
    }

    /* Ajustes finos */
    #app h1 {
      margin: 8px 0;
      font-size: 24px;
      color: var(--brand);
    }
    #app p {
      margin: 0 0 20px;
      color: var(--muted);
    }
    #app .logo {
      margin-bottom: 12px;
    }
    
  </style>
</head>
<body>

  <!-- Pantalla de clave -->
  <div id="gate" class="gate" aria-modal="true" role="dialog">
    <div class="card">
      <h2>Ingreso</h2>
      <label for="pass">IngresÃ¡ la clave para continuar</label>
      <input id="pass" type="password" placeholder="Clave" autocomplete="current-password" />
      <div class="row">
        <button id="enter" class="btn-primary" type="button">Entrar</button>
        <button id="clear" class="btn-secondary" type="button">Limpiar</button>
      </div>
      <div id="msg" class="error" role="status" aria-live="polite"></div>
    </div>
  </div>

  <!-- Contenido real (se muestra tras pasar la clave) -->
  <div id="app" aria-hidden="true">
    <img
      src="https://media.bio.site/sites/thmDAYhuXQgN9KvJZ2tyCh/xMEmbHiT5Ukg9siDtLm85D.png"
      alt="Logo Salve de Vero"
      class="logo"
    />
    <h1>CatÃ¡logo de Productos de Salve de Vero</h1>
    <p>SeleccionÃ¡ una secciÃ³n para comenzar</p>

    <div class="buttons">
      <button
        class="btn-primary"
        onclick="window.location.href='https://script.google.com/macros/s/AKfycbw4xQDEoAtoenleMjF1owTwDr7_sURRieGKSb-r4Iu1glmRAmAqmaoqtDZCbv59v62B/exec'">
        ðŸª· CatÃ¡logo
      </button>
      <button
        class="btn-secondary"
        onclick="window.location.href='https://script.google.com/macros/s/AKfycbw4xQDEoAtoenleMjF1owTwDr7_sURRieGKSb-r4Iu1glmRAmAqmaoqtDZCbv59v62B/exec?view=venta'">
        ðŸ’° Ventas
      </button>
      <button
        class="btn-secondary"
        onclick="window.location.href='https://script.google.com/macros/s/AKfycbw4xQDEoAtoenleMjF1owTwDr7_sURRieGKSb-r4Iu1glmRAmAqmaoqtDZCbv59v62B/exec?page=quick'">
        âš¡ Carga rÃ¡pida de stock
      </button>
      <button
        class="btn-secondary"
        onclick="window.location.href='https://script.google.com/macros/s/AKfycbw4xQDEoAtoenleMjF1owTwDr7_sURRieGKSb-r4Iu1glmRAmAqmaoqtDZCbv59v62B/exec?page=quick-down'">
        ðŸ“¦ Descarga rÃ¡pida de stock
      </button>
      <button
        class="btn-secondary"
        onclick="window.location.href='https://script.google.com/macros/s/AKfycbw4xQDEoAtoenleMjF1owTwDr7_sURRieGKSb-r4Iu1glmRAmAqmaoqtDZCbv59v62B/exec?view=ventas'">
        ðŸ“’ Historial de ventas
      </button>
      <button class="btn-secondary"
        onclick="window.open('https://script.google.com/macros/s/AKfycbw4xQDEoAtoenleMjF1owTwDr7_sURRieGKSb-r4Iu1glmRAmAqmaoqtDZCbv59v62B/exec?view=stats','_blank')">
        ðŸ“Š EstadÃ­sticas de stock
      </button>

    </div>

    <button class="logout" type="button" onclick="logout()">Salir</button>
  </div>

 <script>
  // === CONFIGURÃ ACÃ EL HASH DE TU CLAVE ===
    const HASH_HEX = "9b743e2dbd571093eaca93dbd7adf6e3c9b1608b3bca2f0597e57e6ffa81c2b9";

  const gate = document.getElementById('gate');
  const app = document.getElementById('app');
  const pass = document.getElementById('pass');
  const btnEnter = document.getElementById('enter');
  const btnClear = document.getElementById('clear');
  const msg = document.getElementById('msg');

  function toHex(buffer) {
    return Array.from(new Uint8Array(buffer))
      .map(b => b.toString(16).padStart(2, '0'))
      .join('');
  }

  async function sha256(text) {
    const enc = new TextEncoder();
    const buf = await crypto.subtle.digest('SHA-256', enc.encode(text));
    return toHex(buf);
  }

  async function tryLogin() {
    msg.textContent = '';
    const value = pass.value || '';
    if (!value) {
      msg.textContent = 'IngresÃ¡ la clave.';
      return;
    }
    try {
      const digest = await sha256(value);
      if (digest === HASH_HEX) {
        localStorage.setItem('sv_auth', 'ok');
        openApp();
      } else {
        msg.textContent = 'Clave incorrecta.';
        pass.select();
      }
    } catch (e) {
      msg.textContent = 'Error al validar la clave.';
    }
  }

  // âœ… Muestra el sitio sin romper el layout
  function openApp() {
    gate.classList.add('hidden');
    app.classList.remove('hidden');
    app.setAttribute('aria-hidden', 'false');
  }

  // âœ… Cierra sesiÃ³n y vuelve al login
  function logout() {
    localStorage.removeItem('sv_auth');
    app.classList.add('hidden');
    gate.classList.remove('hidden');
    app.setAttribute('aria-hidden', 'true');
    pass.value = '';
    pass.focus();
  }

  btnEnter.addEventListener('click', tryLogin);
  btnClear.addEventListener('click', () => {
    pass.value = '';
    pass.focus();
  });
  pass.addEventListener('keydown', e => {
    if (e.key === 'Enter') tryLogin();
  });

  // Auto-login si ya se validÃ³ antes
  (function init() {
    if (localStorage.getItem('sv_auth') === 'ok') {
      openApp();
    } else {
      gate.classList.remove('hidden');
      pass.focus();
    }
  })();
</script>

</body>
</html>
